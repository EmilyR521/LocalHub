<section class="card card-table-scroll">
  <div class="actions" style="margin-bottom: 1rem;">
    <button type="button" class="btn primary" (click)="onAddBook()">Add book</button>
    <div class="plugin-actions" style="margin-bottom: 0;">
      <label>
        <span class="hint" style="margin: 0 0.5rem 0 0;">Status:</span>
        <select class="form-select" [value]="statusFilter()" (change)="setStatusFilter($any($event.target).value)">
          @for (s of statusOptions; track s) {
            <option [value]="s">{{ s || 'All' }}</option>
          }
        </select>
      </label>
    </div>
  </div>

  <div class="data-table-wrap">
    <table class="data-table">
      <thead>
        <tr>
          <th class="sortable" (click)="setSort('title')">Title</th>
          <th class="sortable" (click)="setSort('author')">Author</th>
          <th class="sortable" (click)="setSort('status')">Status</th>
          <th class="sortable" (click)="setSort('readingEndDate')">Finished</th>
          <th>Rating</th>
          <th>Tags</th>
        </tr>
      </thead>
      <tbody>
        @for (book of filteredAndSortedBooks(); track book.id) {
          <tr class="clickable" (click)="onViewBook(book)">
            <td>{{ book.title }}</td>
            <td>{{ book.author }}</td>
            <td><span class="status-badge">{{ book.status }}</span></td>
            <td class="empty-cell">{{ formatDate(book.readingEndDate) }}</td>
            <td><span class="rating-icon">{{ ratingIcon(book.rating) || '—' }}</span></td>
            <td class="empty-cell">{{ (book.tags ?? []).length ? (book.tags ?? []).join(', ') : '—' }}</td>
          </tr>
        }
        @if (filteredAndSortedBooks().length === 0) {
          <tr>
            <td colspan="6" class="empty-cell">{{ statusFilter() ? 'No books match the filter' : 'No books yet. Add one above.' }}</td>
          </tr>
        }
      </tbody>
    </table>
  </div>
</section>
